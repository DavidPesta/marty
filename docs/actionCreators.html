<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Action Creators | marty.js</title>
  <meta name="viewport" content="width=device-width">

  <link rel="shortcut icon" href="/favicon.ico?v=1" type="image/x-icon">

  <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/css/codemirror.css">
  <link rel="stylesheet" type="text/css" href="/css/docs.css">

  <script type="text/javascript" src="/js/codemirror.js"></script>
</head>
<body>
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/" class="navbar-brand">marty.js</a>
      </div>
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav">
          <li>
            <a href="/getting-started/">Getting started</a>
          </li>
          <li>
            <a href="/docs">Documentation</a>

            <ul class="nav sub-nav visible-xs-block">
              
              
              
                
                  
                
              
                
                  
                
              
                
                  
                    
                    <li><a href="/docs/index.html">Overview</a></li>
                    
                  
                
              
                
                  
                    
                    <li><a href="/docs/stores.html">Stores</a></li>
                    
                  
                
              
                
                  
                    
                    <li class="active"><a href="/docs/actionCreators.html" class="active">Action Creators</a></li>
                    
                  
                
              
                
                  
                    
                    <li><a href="/docs/stateMixin.html">State mixin</a></li>
                    
                  
                
              
                
                  
                    
                    <li><a href="/docs/httpApi.html">HTTP API</a></li>
                    
                  
                
              
                
                  
                    
                    <li><a href="/docs/constants.html">Constants</a></li>
                    
                  
                
              
                
                  
                    
                    <li><a href="/docs/dispatcher.html">Dispatcher</a></li>
                    
                  
                
              
              
              
            </ul>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="http://github.com/jhollingworth/marty">
              <i class="fa fa-github"></i>
              Github
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>
  <div class="bs-docs-header" id="content"  style="background-color: #D65D28">
  <div class="container">
    <h1>Action Creators</h1>
    <p></p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-9" role="main">
      <div class="bs-docs-section">
        <p>Action Creators are where any changes to your applications state starts. Actions are functions that are responsible for coordinating changes to local and remote state.</p>

<p>All actions have a type which is string which gives a terse description of what the action does (e.g. &quot;UPDATE_USER_EMAIL&quot;). Stores listen for new actions (using the <a href="/docs/dispatcher.html">dispatcher</a>) and use <a href="/docs/stores.html#handlers">action&#39;s type to determine whether to do something with it</a>. Using strings helps us build loosely coupled applications that can grow without increasing complexity. </p>

<p>Lets look at how you define an action creator using marty:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">UserActionCreators</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createActionCreators</span><span class="p">({</span>
  <span class="na">updateEmail</span><span class="p">:</span> <span class="p">[</span><span class="s2">"UPDATE_EMAIL"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">}]</span>
<span class="p">});</span>

<span class="nx">UserActionCreators</span><span class="p">.</span><span class="nx">updateEmail</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s2">"foo@bar.com"</span><span class="p">);</span></code></pre></div>

<p>In this case the actions type is &quot;UPDATE_EMAIL&quot; and the second function in the array is the action which will be invoked when you call <code>updateEmail</code>. We found that more often than not the action type is the same as the actions function name so by convention we camelize, underscore and upper case it. In the above example, specifying the action type is superfluous because updateEmail becomes &quot;UPDATE_EMAIL&quot;.</p>
<div class="highlight"><pre><code class="language-" data-lang="">var UserActionCreators = Marty.createActionCreators({
  updateEmail: function (userId, email) {
    ...
  }
});
</code></pre></div>
<p>If you want to make a change locally, you can use <code>this.dispatch()</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">var UserActionCreators = Marty.createActionCreators({
  updateEmail: function (userId, email) {
    this.dispatch(userId, email);
  }
});

Marty.dispatcher.register(function (action) {
  console.log(action.type) // =&gt; "UPDATE_EMAIL"
  console.log(action.arguments) // =&gt; [123, "foo@bar.com"];
});

UserActionCreators.updateEmail(123, "foo@bar.com");
</code></pre></div>
<p>Action creators become more complex when you start involving remote requests since they involve asynchronous calls and have the potential to fail. Traditionally you would pass in a callback or return a promise but comply with Flux&#39;s unidirectional data flow rule. So we need a different approach to ensure data is flowing in the right direction.</p>

<p>Marty has an Actions store (<code>Marty.Stores.Actions</code>) which knows about all actions. When you create an action, it will return an <strong>action token</strong> which you can use to get the status of an action.</p>
<div class="highlight"><pre><code class="language-" data-lang="">var UserActionCreators = Marty.createActionCreators({
  createUser: function (user) {
    return UserAPI.createUser(user);
  }
});

var createUserToken = UserActionCreators.createUser(user);

Marty.Stores.Actions.addChangeListener(function () {
  var action = Marty.getAction(createUserAction); // Shortcut for Marty.Stores.Actions.getAction()
  console.log(action.status)
});
</code></pre></div>
<p>Like <a href="/docs/stores.html#query">store queries</a>, an action&#39;s status can either be <strong>pending</strong>, <strong>done</strong> or <strong>error</strong>. If you are using the <a href="/docs/stateMixin.html">state mixin</a> then it automatically listens to the actions store (<a href="/docs/stateMixin.html#listenToActions">unless you tell it not to</a>).</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">UserFormState</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createStateMixin</span><span class="p">({</span>
  <span class="na">getState</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">createUser</span><span class="p">:</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">getAction</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">createUserToken</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="kd">var</span> <span class="nx">UserForm</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createActionCreators</span><span class="p">({</span>
  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">createUser</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">createUser</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">createUser</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">createUser</span><span class="p">.</span><span class="nx">pending</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'creating user'</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">createUser</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'creating user failed'</span><span class="p">,</span> <span class="nx">createUser</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span> 
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">createUser</span><span class="p">.</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'creating user done'</span><span class="p">,</span> <span class="nx">createUser</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span> 
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">createUser</span><span class="err">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="na">createUserToken</span><span class="p">:</span> <span class="nx">UserActionCreators</span><span class="p">.</span><span class="nx">createUser</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></div>

<h2 id="api">API</h2>

<h3 id="createActionCreators">createActionCreators(props)</h3>

<p>To create some new action creators, you call <code>Marty.createActionCreators</code> passing in a set of properties. It returns your action creators as a singleton.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">UserActionCreators</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createActionCreators</span><span class="p">({</span>
  <span class="na">addUser</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></div>

<h3 id="name">name</h3>

<p>An (optional) display name for the action creator. Used for richer debugging.</p>

<h3 id="dispatch">dispatch([...])</h3>

<p>Dispatches an action payload. Any <a href="/docs/stores.html#handleAction">action handlers</a> will be invoked with the given action handlers. </p>

<p>Returns <code>Action</code>. You can rollback an action by calling <code>action.rollback()</code>.</p>

<h3 id="getActionType">getActionType(functionName)</h3>

<p>Returns the action type for a given function name. The default implementation will camelize, underscore and upper case the function name (fooBarBaz becomes &quot;FOO_BAR_BAZ&quot;). To implement your own naming strategy you can re-implement this function.</p>

<h2 id="server-action-creators">Server Action Creators</h2>

<p>Action creators often will call an <a href="/docs/httpApi.html">Http API</a> which, when complete, will then call another action creator with the new data. If you are using a module loader (e.g. CommonJS, AMD) it can cause a cyclic dependency between the Action Creator and the HTTP API.</p>

<p>The way to get around this is to have a seperate action creator, called a Server Action Creator, that is responsible for handling responses from Http APIs.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">UserActionCreators</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createActionCreators</span><span class="p">({</span>
  <span class="na">saveUser</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">UserAPI</span><span class="p">.</span><span class="nx">saveUser</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">UserServerActionCreators</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createActionCreators</span><span class="p">({</span>
  <span class="na">addUser</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">UserAPI</span> <span class="o">=</span> <span class="nx">Marty</span><span class="p">.</span><span class="nx">createHttpAPI</span><span class="p">({</span>
  <span class="na">saveUser</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span> <span class="na">url</span><span class="p">:</span> <span class="s1">'/users'</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="nx">user</span> <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">UserServerActionCreators</span><span class="p">.</span><span class="nx">addUser</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></div>

<h2 id="actions-vs-action-creators">Actions vs Action Creators</h2>

<p>There has been some confusion around actions and action creators. In the <a href="http://facebook.github.io/flux/docs/overview.html">original blog announcing Flux</a>, <a href="http://facebook.github.io/flux/docs/overview.html#actions">action creators were called actions</a>. Since then, the creators of Flux have <a href="https://groups.google.com/d/msg/reactjs/jBPHH4Q-8Sc/zwObiX9UT2EJ">decided to rename actions to action creators</a> because &quot;they create actions but are not themselves actually the action itself&quot;.</p>

<p>Utilmately this is just semantics so actions and action creators are terms that can be used interchangeably.</p>

<h2 id="further-reading">Further reading</h2>

<ul>
<li><a href="http://facebook.github.io/react/blog/2014/07/30/flux-actions-and-the-dispatcher.html#actions-and-actioncreators">Actions and Action Creators</a></li>
<li><a href="https://groups.google.com/forum/#!topic/reactjs/jBPHH4Q-8Sc">Discussion on actions &amp; action creators</a></li>
<li><a href="http://facebook.github.io/flux/docs/overview.html#stores">Original article about Flux</a></li>
</ul>

      </div>
    </div>
    <div class="col-md-3">
      <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix-top" role="complementary">
        <ul class="nav bs-docs-sidenav">
          
          
          
            
              
            
          
            
              
            
          
            
              
                
                <li><a href="/docs/index.html">Overview</a></li>
                
              
            
          
            
              
                
                <li><a href="/docs/stores.html">Stores</a></li>
                
              
            
          
            
              
                
                <li class="active"><a href="/docs/actionCreators.html" class="active">Action Creators</a></li>
                
              
            
          
            
              
                
                <li><a href="/docs/stateMixin.html">State mixin</a></li>
                
              
            
          
            
              
                
                <li><a href="/docs/httpApi.html">HTTP API</a></li>
                
              
            
          
            
              
                
                <li><a href="/docs/constants.html">Constants</a></li>
                
              
            
          
            
              
                
                <li><a href="/docs/dispatcher.html">Dispatcher</a></li>
                
              
            
          
          
          
        </ul>
      </div>
    </div>
</div>

  <footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
      <p>Code licensed under <a href="https://github.com/jhollingworth/marty/blob/master/LICENSE" target="_blank">MIT</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
      <ul class="bs-docs-footer-links muted">
        <li>v0.1.0</li>
        <li>·</li>
        <li><a href="https://github.com/jhollingworth/marty">GitHub</a></li>
        <li>·</li>
        <li><a href="https://github.com/jhollingworth/marty/issues">Issues</a></li>
        <li>·</li>
        <li><a href="https://github.com/jhollingworth/marty/releases">Releases</a></li>
      </ul>
    </div>
  </footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56575082-1', 'auto');
    ga('send', 'pageview');

  </script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="/js/headings.js"></script>
  <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
</body>
</html>